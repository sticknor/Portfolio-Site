{"ast":null,"code":"\"use strict\";\n\nvar _slicedToArray = require(\"/Users/samticknor/Portfolio-Site/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/slicedToArray\");\nvar __createBinding = this && this.__createBinding || (Object.create ? function (o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  var desc = Object.getOwnPropertyDescriptor(m, k);\n  if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n    desc = {\n      enumerable: true,\n      get: function get() {\n        return m[k];\n      }\n    };\n  }\n  Object.defineProperty(o, k2, desc);\n} : function (o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  o[k2] = m[k];\n});\nvar __setModuleDefault = this && this.__setModuleDefault || (Object.create ? function (o, v) {\n  Object.defineProperty(o, \"default\", {\n    enumerable: true,\n    value: v\n  });\n} : function (o, v) {\n  o[\"default\"] = v;\n});\nvar __importStar = this && this.__importStar || function (mod) {\n  if (mod && mod.__esModule) return mod;\n  var result = {};\n  if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n  __setModuleDefault(result, mod);\n  return result;\n};\nvar __rest = this && this.__rest || function (s, e) {\n  var t = {};\n  for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0) t[p] = s[p];\n  if (s != null && typeof Object.getOwnPropertySymbols === \"function\") for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n    if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i])) t[p[i]] = s[p[i]];\n  }\n  return t;\n};\nvar __importDefault = this && this.__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    \"default\": mod\n  };\n};\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.InstagramEmbed = void 0;\nvar classnames_1 = __importDefault(require(\"classnames\"));\nvar React = __importStar(require(\"react\"));\nvar react_sub_unsub_1 = require(\"react-sub-unsub\");\nvar useFrame_1 = require(\"../hooks/useFrame\");\nvar PlaceholderEmbed_1 = require(\"../placeholder/PlaceholderEmbed\");\nvar uuid_1 = require(\"../uuid\");\nvar EmbedStyle_1 = require(\"./EmbedStyle\");\nvar embedJsScriptSrc = '//www.instagram.com/embed.js';\nvar minPlaceholderWidth = 328;\nvar defaultPlaceholderHeight = 372;\nvar borderRadius = 3;\n// Embed Stages\nvar CHECK_SCRIPT_STAGE = 'check-script';\nvar LOAD_SCRIPT_STAGE = 'load-script';\nvar CONFIRM_SCRIPT_LOADED_STAGE = 'confirm-script-loaded';\nvar PROCESS_EMBED_STAGE = 'process-embed';\nvar CONFIRM_EMBED_SUCCESS_STAGE = 'confirm-embed-success';\nvar RETRYING_STAGE = 'retrying';\nvar EMBED_SUCCESS_STAGE = 'embed-success';\nvar InstagramEmbed = function InstagramEmbed(_a) {\n  var _b, _c;\n  var url = _a.url,\n    width = _a.width,\n    height = _a.height,\n    _a$linkText = _a.linkText,\n    linkText = _a$linkText === void 0 ? 'View post on Instagram' : _a$linkText,\n    placeholderImageUrl = _a.placeholderImageUrl,\n    placeholderSpinner = _a.placeholderSpinner,\n    _a$placeholderSpinner = _a.placeholderSpinnerDisabled,\n    placeholderSpinnerDisabled = _a$placeholderSpinner === void 0 ? false : _a$placeholderSpinner,\n    placeholderProps = _a.placeholderProps,\n    embedPlaceholder = _a.embedPlaceholder,\n    _a$placeholderDisable = _a.placeholderDisabled,\n    placeholderDisabled = _a$placeholderDisable === void 0 ? false : _a$placeholderDisable,\n    _a$scriptLoadDisabled = _a.scriptLoadDisabled,\n    scriptLoadDisabled = _a$scriptLoadDisabled === void 0 ? false : _a$scriptLoadDisabled,\n    _a$retryDelay = _a.retryDelay,\n    retryDelay = _a$retryDelay === void 0 ? 5000 : _a$retryDelay,\n    _a$retryDisabled = _a.retryDisabled,\n    retryDisabled = _a$retryDisabled === void 0 ? false : _a$retryDisabled,\n    _a$igVersion = _a.igVersion,\n    igVersion = _a$igVersion === void 0 ? '14' : _a$igVersion,\n    _a$frame = _a.frame,\n    frame = _a$frame === void 0 ? undefined : _a$frame,\n    _a$debug = _a.debug,\n    debug = _a$debug === void 0 ? false : _a$debug,\n    divProps = __rest(_a, [\"url\", \"width\", \"height\", \"linkText\", \"placeholderImageUrl\", \"placeholderSpinner\", \"placeholderSpinnerDisabled\", \"placeholderProps\", \"embedPlaceholder\", \"placeholderDisabled\", \"scriptLoadDisabled\", \"retryDelay\", \"retryDisabled\", \"igVersion\", \"frame\", \"debug\"]);\n  var _React$useState = React.useState(CHECK_SCRIPT_STAGE),\n    _React$useState2 = _slicedToArray(_React$useState, 2),\n    stage = _React$useState2[0],\n    setStage = _React$useState2[1];\n  var uuidRef = React.useRef((0, uuid_1.generateUUID)());\n  var _React$useState3 = React.useState(Date.now()),\n    _React$useState4 = _slicedToArray(_React$useState3, 2),\n    processTime = _React$useState4[0],\n    setProcessTime = _React$useState4[1];\n  var embedContainerKey = React.useMemo(function () {\n    return \"\".concat(uuidRef.current, \"-\").concat(processTime);\n  }, [processTime]);\n  var frm = (0, useFrame_1.useFrame)(frame);\n  // Debug Output\n  React.useEffect(function () {\n    debug && console.log(\"[\".concat(new Date().toISOString(), \"]: \").concat(stage));\n  }, [debug, stage]);\n  // === === === === === === === === === === === === === === === === === === ===\n  // Embed Stages\n  // === === === === === === === === === === === === === === === === === === ===\n  // Check Script Stage\n  React.useEffect(function () {\n    var _a, _b, _c;\n    if (stage === CHECK_SCRIPT_STAGE) {\n      if ((_c = (_b = (_a = frm.window) === null || _a === void 0 ? void 0 : _a.instgrm) === null || _b === void 0 ? void 0 : _b.Embeds) === null || _c === void 0 ? void 0 : _c.process) {\n        setStage(PROCESS_EMBED_STAGE);\n      } else if (!scriptLoadDisabled) {\n        setStage(LOAD_SCRIPT_STAGE);\n      } else {\n        console.error('Instagram embed script not found. Unable to process Instagram embed:', url);\n      }\n    }\n  }, [scriptLoadDisabled, stage, url, frm.window]);\n  // Load Script Stage\n  React.useEffect(function () {\n    if (stage === LOAD_SCRIPT_STAGE) {\n      if (frm.document) {\n        var scriptElement = frm.document.createElement('script');\n        scriptElement.setAttribute('src', embedJsScriptSrc);\n        frm.document.head.appendChild(scriptElement);\n        setStage(CONFIRM_SCRIPT_LOADED_STAGE);\n      }\n    }\n  }, [stage, frm.document]);\n  // Confirm Script Loaded Stage\n  React.useEffect(function () {\n    var subs = new react_sub_unsub_1.Subs();\n    if (stage === CONFIRM_SCRIPT_LOADED_STAGE) {\n      subs.setInterval(function () {\n        var _a, _b, _c;\n        if ((_c = (_b = (_a = frm.window) === null || _a === void 0 ? void 0 : _a.instgrm) === null || _b === void 0 ? void 0 : _b.Embeds) === null || _c === void 0 ? void 0 : _c.process) {\n          setStage(PROCESS_EMBED_STAGE);\n        }\n      }, 1);\n    }\n    return subs.createCleanup();\n  }, [stage, frm.window]);\n  // Process Embed Stage\n  React.useEffect(function () {\n    var _a, _b, _c;\n    if (stage === PROCESS_EMBED_STAGE) {\n      var process = (_c = (_b = (_a = frm.window) === null || _a === void 0 ? void 0 : _a.instgrm) === null || _b === void 0 ? void 0 : _b.Embeds) === null || _c === void 0 ? void 0 : _c.process;\n      if (process) {\n        process();\n        setStage(CONFIRM_EMBED_SUCCESS_STAGE);\n      } else {\n        console.error('Instagram embed script not found. Unable to process Instagram embed:', url);\n      }\n    }\n  }, [stage, frm.window, url]);\n  // Confirm Embed Success Stage\n  React.useEffect(function () {\n    var subs = new react_sub_unsub_1.Subs();\n    if (stage === CONFIRM_EMBED_SUCCESS_STAGE) {\n      subs.setInterval(function () {\n        if (frm.document) {\n          var preEmbedElement = frm.document.getElementById(uuidRef.current);\n          if (!preEmbedElement) {\n            setStage(EMBED_SUCCESS_STAGE);\n          }\n        }\n      }, 1);\n      if (!retryDisabled) {\n        subs.setTimeout(function () {\n          setStage(RETRYING_STAGE);\n        }, retryDelay);\n      }\n    }\n    return subs.createCleanup();\n  }, [retryDelay, retryDisabled, stage, frm.document]);\n  // Retrying Stage\n  React.useEffect(function () {\n    if (stage === RETRYING_STAGE) {\n      // This forces the embed container to remount\n      setProcessTime(Date.now());\n      setStage(PROCESS_EMBED_STAGE);\n    }\n  }, [stage]);\n  // END Embed Stages\n  // === === === === === === === === === === === === === === === === === === ===\n  var urlWithNoQuery = url.replace(/[?].*$/, '');\n  var cleanUrlWithEndingSlash = \"\".concat(urlWithNoQuery).concat(urlWithNoQuery.endsWith('/') ? '' : '/');\n  var isPercentageWidth = !!(width === null || width === void 0 ? void 0 : width.toString().includes('%'));\n  var isPercentageHeight = !!(height === null || height === void 0 ? void 0 : height.toString().includes('%'));\n  // === Placeholder ===\n  var placeholderStyle = {\n    minWidth: isPercentageWidth ? undefined : minPlaceholderWidth,\n    width: typeof width !== 'undefined' ? isPercentageWidth ? '100%' : width : '100%',\n    height: isPercentageHeight ? '100%' : typeof height !== 'undefined' ? height : typeof ((_b = divProps.style) === null || _b === void 0 ? void 0 : _b.height) !== 'undefined' || typeof ((_c = divProps.style) === null || _c === void 0 ? void 0 : _c.maxHeight) !== 'undefined' ? '100%' : defaultPlaceholderHeight,\n    border: '1px solid #dee2e6',\n    borderRadius: borderRadius\n  };\n  var placeholder = embedPlaceholder !== null && embedPlaceholder !== void 0 ? embedPlaceholder : React.createElement(PlaceholderEmbed_1.PlaceholderEmbed, Object.assign({\n    url: cleanUrlWithEndingSlash,\n    imageUrl: placeholderImageUrl,\n    linkText: linkText,\n    spinner: placeholderSpinner,\n    spinnerDisabled: placeholderSpinnerDisabled\n  }, placeholderProps, {\n    style: Object.assign(Object.assign({}, placeholderStyle), placeholderProps === null || placeholderProps === void 0 ? void 0 : placeholderProps.style)\n  }));\n  // === END Placeholder ===\n  return React.createElement(\"div\", Object.assign({}, divProps, {\n    className: (0, classnames_1.default)('rsme-embed rsme-instagram-embed', uuidRef.current, divProps.className),\n    style: Object.assign({\n      overflow: 'hidden',\n      width: width !== null && width !== void 0 ? width : undefined,\n      height: height !== null && height !== void 0 ? height : undefined,\n      borderRadius: borderRadius\n    }, divProps.style)\n  }), React.createElement(EmbedStyle_1.EmbedStyle, null), React.createElement(\"blockquote\", {\n    key: embedContainerKey,\n    className: \"instagram-media\",\n    \"data-instgrm-permalink\": \"\".concat(cleanUrlWithEndingSlash, \"?utm_source=ig_embed&utm_campaign=loading\"),\n    \"data-instgrm-version\": igVersion,\n    \"data-instgrm-captioned\": true,\n    \"data-width\": isPercentageWidth ? '100%' : width !== null && width !== void 0 ? width : undefined,\n    style: {\n      width: 'calc(100% - 2px)'\n    }\n  }, !placeholderDisabled && placeholder, React.createElement(\"div\", {\n    id: uuidRef.current,\n    className: \"instagram-media-pre-embed rsme-d-none\"\n  }, \"\\xA0\")));\n};\nexports.InstagramEmbed = InstagramEmbed;","map":null,"metadata":{},"sourceType":"script"}