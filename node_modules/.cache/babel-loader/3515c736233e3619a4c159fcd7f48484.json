{"ast":null,"code":"\"use strict\";\n\nvar _slicedToArray = require(\"/Users/samticknor/Portfolio-Site/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/slicedToArray\");\nvar __rest = this && this.__rest || function (s, e) {\n  var t = {};\n  for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0) t[p] = s[p];\n  if (s != null && typeof Object.getOwnPropertySymbols === \"function\") for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n    if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i])) t[p[i]] = s[p[i]];\n  }\n  return t;\n};\nvar __importDefault = this && this.__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    \"default\": mod\n  };\n};\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.FacebookEmbed = void 0;\nvar classnames_1 = __importDefault(require(\"classnames\"));\nvar react_1 = __importDefault(require(\"react\"));\nvar useFrame_1 = require(\"../hooks/useFrame\");\nvar PlaceholderEmbed_1 = require(\"../placeholder/PlaceholderEmbed\");\nvar uuid_1 = require(\"../uuid\");\nvar EmbedStyle_1 = require(\"./EmbedStyle\");\nvar react_sub_unsub_1 = require(\"react-sub-unsub\");\nvar embedJsScriptSrc = 'https://connect.facebook.net/en_US/sdk.js#xfbml=1&version=v16.0';\nvar defaultEmbedWidth = 550;\nvar maxPlaceholderWidth = defaultEmbedWidth;\nvar defaultPlaceholderHeight = 372;\nvar borderRadius = 3;\n// Embed Stages\nvar CHECK_SCRIPT_STAGE = 'check-script';\nvar LOAD_SCRIPT_STAGE = 'load-script';\nvar CONFIRM_SCRIPT_LOADED_STAGE = 'confirm-script-loaded';\nvar PROCESS_EMBED_STAGE = 'process-embed';\nvar CONFIRM_EMBED_SUCCESS_STAGE = 'confirm-embed-success';\nvar RETRYING_STAGE = 'retrying';\nvar EMBED_SUCCESS_STAGE = 'embed-success';\nvar FacebookEmbed = function FacebookEmbed(_a) {\n  var _b, _c;\n  var url = _a.url,\n    width = _a.width,\n    height = _a.height,\n    _a$linkText = _a.linkText,\n    linkText = _a$linkText === void 0 ? 'View post on Facebook' : _a$linkText,\n    placeholderImageUrl = _a.placeholderImageUrl,\n    placeholderSpinner = _a.placeholderSpinner,\n    _a$placeholderSpinner = _a.placeholderSpinnerDisabled,\n    placeholderSpinnerDisabled = _a$placeholderSpinner === void 0 ? false : _a$placeholderSpinner,\n    placeholderProps = _a.placeholderProps,\n    embedPlaceholder = _a.embedPlaceholder,\n    _a$placeholderDisable = _a.placeholderDisabled,\n    placeholderDisabled = _a$placeholderDisable === void 0 ? false : _a$placeholderDisable,\n    _a$scriptLoadDisabled = _a.scriptLoadDisabled,\n    scriptLoadDisabled = _a$scriptLoadDisabled === void 0 ? false : _a$scriptLoadDisabled,\n    _a$retryDelay = _a.retryDelay,\n    retryDelay = _a$retryDelay === void 0 ? 5000 : _a$retryDelay,\n    _a$retryDisabled = _a.retryDisabled,\n    retryDisabled = _a$retryDisabled === void 0 ? false : _a$retryDisabled,\n    _a$frame = _a.frame,\n    frame = _a$frame === void 0 ? undefined : _a$frame,\n    _a$debug = _a.debug,\n    debug = _a$debug === void 0 ? false : _a$debug,\n    divProps = __rest(_a, [\"url\", \"width\", \"height\", \"linkText\", \"placeholderImageUrl\", \"placeholderSpinner\", \"placeholderSpinnerDisabled\", \"placeholderProps\", \"embedPlaceholder\", \"placeholderDisabled\", \"scriptLoadDisabled\", \"retryDelay\", \"retryDisabled\", \"frame\", \"debug\"]);\n  var _react_1$default$useS = react_1.default.useState(CHECK_SCRIPT_STAGE),\n    _react_1$default$useS2 = _slicedToArray(_react_1$default$useS, 2),\n    stage = _react_1$default$useS2[0],\n    setStage = _react_1$default$useS2[1];\n  var embedSuccess = react_1.default.useMemo(function () {\n    return stage === EMBED_SUCCESS_STAGE;\n  }, [stage]);\n  var uuidRef = react_1.default.useRef((0, uuid_1.generateUUID)());\n  var _react_1$default$useS3 = react_1.default.useState(Date.now()),\n    _react_1$default$useS4 = _slicedToArray(_react_1$default$useS3, 2),\n    processTime = _react_1$default$useS4[0],\n    setProcessTime = _react_1$default$useS4[1];\n  var embedContainerKey = react_1.default.useMemo(function () {\n    return \"\".concat(uuidRef.current, \"-\").concat(processTime);\n  }, [processTime]);\n  var frm = (0, useFrame_1.useFrame)(frame);\n  // Debug Output\n  react_1.default.useEffect(function () {\n    debug && console.log(\"[\".concat(new Date().toISOString(), \"]: \").concat(stage));\n  }, [debug, stage]);\n  // === === === === === === === === === === === === === === === === === === ===\n  // Embed Stages\n  // === === === === === === === === === === === === === === === === === === ===\n  // Check Script Stage\n  react_1.default.useEffect(function () {\n    var _a, _b, _c;\n    if (stage === CHECK_SCRIPT_STAGE) {\n      if ((_c = (_b = (_a = frm.window) === null || _a === void 0 ? void 0 : _a.FB) === null || _b === void 0 ? void 0 : _b.XFBML) === null || _c === void 0 ? void 0 : _c.parse) {\n        setStage(PROCESS_EMBED_STAGE);\n      } else if (!scriptLoadDisabled) {\n        setStage(LOAD_SCRIPT_STAGE);\n      } else {\n        console.error('Facebook embed script not found. Unable to process Facebook embed:', url);\n      }\n    }\n  }, [scriptLoadDisabled, stage, url, frm.window]);\n  // Load Script Stage\n  react_1.default.useEffect(function () {\n    if (stage === LOAD_SCRIPT_STAGE) {\n      if (frm.document) {\n        var scriptElement = frm.document.createElement('script');\n        scriptElement.setAttribute('src', embedJsScriptSrc);\n        frm.document.head.appendChild(scriptElement);\n        setStage(CONFIRM_SCRIPT_LOADED_STAGE);\n      }\n    }\n  }, [stage, frm.document]);\n  // Confirm Script Loaded Stage\n  react_1.default.useEffect(function () {\n    var subs = new react_sub_unsub_1.Subs();\n    if (stage === CONFIRM_SCRIPT_LOADED_STAGE) {\n      subs.setInterval(function () {\n        var _a, _b, _c;\n        if ((_c = (_b = (_a = frm.window) === null || _a === void 0 ? void 0 : _a.FB) === null || _b === void 0 ? void 0 : _b.XFBML) === null || _c === void 0 ? void 0 : _c.parse) {\n          setStage(PROCESS_EMBED_STAGE);\n        }\n      }, 1);\n    }\n    return subs.createCleanup();\n  }, [stage, frm.window]);\n  // Process Embed Stage\n  react_1.default.useEffect(function () {\n    var _a, _b, _c;\n    if (stage === PROCESS_EMBED_STAGE) {\n      var parse = (_c = (_b = (_a = frm.window) === null || _a === void 0 ? void 0 : _a.FB) === null || _b === void 0 ? void 0 : _b.XFBML) === null || _c === void 0 ? void 0 : _c.parse;\n      if (parse) {\n        parse();\n        setStage(CONFIRM_EMBED_SUCCESS_STAGE);\n      } else {\n        console.error('Facebook embed script not found. Unable to process Facebook embed:', url);\n      }\n    }\n  }, [stage, url, frm.window]);\n  // Confirm Embed Success Stage\n  react_1.default.useEffect(function () {\n    var subs = new react_sub_unsub_1.Subs();\n    if (stage === CONFIRM_EMBED_SUCCESS_STAGE) {\n      subs.setInterval(function () {\n        if (frm.document) {\n          var fbPostContainerElement = frm.document.getElementById(uuidRef.current);\n          if (fbPostContainerElement) {\n            var fbPostElem = fbPostContainerElement.getElementsByClassName('fb-post')[0];\n            if (fbPostElem) {\n              if (fbPostElem.children.length > 0) {\n                setStage(EMBED_SUCCESS_STAGE);\n              }\n            }\n          }\n        }\n      }, 1);\n      if (!retryDisabled) {\n        subs.setTimeout(function () {\n          setStage(RETRYING_STAGE);\n        }, retryDelay);\n      }\n    }\n    return subs.createCleanup();\n  }, [retryDisabled, retryDelay, stage, frm.document]);\n  // Retrying Stage\n  react_1.default.useEffect(function () {\n    if (stage === RETRYING_STAGE) {\n      // This forces the embed container to remount\n      setProcessTime(Date.now());\n      setStage(PROCESS_EMBED_STAGE);\n    }\n  }, [stage]);\n  // END Embed Stages\n  // === === === === === === === === === === === === === === === === === === ===\n  var isPercentageWidth = !!(width === null || width === void 0 ? void 0 : width.toString().includes('%'));\n  var isPercentageHeight = !!(height === null || height === void 0 ? void 0 : height.toString().includes('%'));\n  // === Placeholder ===\n  var placeholderStyle = {\n    maxWidth: isPercentageWidth ? undefined : maxPlaceholderWidth,\n    width: typeof width !== 'undefined' ? isPercentageWidth ? '100%' : width : '100%',\n    height: isPercentageHeight ? '100%' : typeof height !== 'undefined' ? height : typeof ((_b = divProps.style) === null || _b === void 0 ? void 0 : _b.height) !== 'undefined' || typeof ((_c = divProps.style) === null || _c === void 0 ? void 0 : _c.maxHeight) !== 'undefined' ? '100%' : defaultPlaceholderHeight,\n    border: '1px solid #dee2e6',\n    borderRadius: borderRadius\n  };\n  var placeholder = embedPlaceholder !== null && embedPlaceholder !== void 0 ? embedPlaceholder : react_1.default.createElement(PlaceholderEmbed_1.PlaceholderEmbed, Object.assign({\n    url: url,\n    imageUrl: placeholderImageUrl,\n    linkText: linkText,\n    spinner: placeholderSpinner,\n    spinnerDisabled: placeholderSpinnerDisabled\n  }, placeholderProps, {\n    style: Object.assign(Object.assign({}, placeholderStyle), placeholderProps === null || placeholderProps === void 0 ? void 0 : placeholderProps.style)\n  }));\n  // === END Placeholder ===\n  return react_1.default.createElement(\"div\", Object.assign({}, divProps, {\n    className: (0, classnames_1.default)('rsme-embed rsme-facebook-embed', divProps.className),\n    style: Object.assign({\n      overflow: 'hidden',\n      width: width !== null && width !== void 0 ? width : undefined,\n      height: height !== null && height !== void 0 ? height : undefined,\n      borderRadius: borderRadius\n    }, divProps.style)\n  }), react_1.default.createElement(EmbedStyle_1.EmbedStyle, null), react_1.default.createElement(\"div\", {\n    id: uuidRef.current,\n    className: (0, classnames_1.default)(!embedSuccess && 'rsme-d-none')\n  }, react_1.default.createElement(\"div\", {\n    key: embedContainerKey,\n    className: \"fb-post\",\n    \"data-href\": url,\n    \"data-width\": isPercentageWidth ? '100%' : width !== null && width !== void 0 ? width : defaultEmbedWidth,\n    style: {\n      width: isPercentageWidth ? '100%' : width !== null && width !== void 0 ? width : defaultEmbedWidth,\n      height: isPercentageHeight ? '100%' : height !== null && height !== void 0 ? height : undefined\n    }\n  })), !embedSuccess && !placeholderDisabled && placeholder);\n};\nexports.FacebookEmbed = FacebookEmbed;","map":null,"metadata":{},"sourceType":"script"}